package com.bacunguyenandroid.cdcswitchclient.Fragment;import android.content.Context;import android.content.Intent;import android.content.pm.PackageInfo;import android.os.AsyncTask;import android.os.Bundle;import android.support.annotation.NonNull;import android.support.annotation.Nullable;import android.support.v4.app.Fragment;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.AdapterView;import android.widget.GridView;import com.bacunguyenandroid.cdcswitchclient.Adapter.GridViewAdapter;import com.bacunguyenandroid.cdcswitchclient.GameService;import com.bacunguyenandroid.cdcswitchclient.MainActivity;import com.bacunguyenandroid.cdcswitchclient.Net.TalkCode;import com.bacunguyenandroid.cdcswitchclient.Net.Talkcontent;import com.bacunguyenandroid.cdcswitchclient.R;import com.bacunguyenandroid.cdcswitchclient.Tool.LoadGappsCurrent;import java.util.List;public class ChooseFra extends Fragment implements AdapterView.OnItemClickListener {    // TODO: biến    private GridView gridView;    private  View view;    private List<PackageInfo> packageInfos;    private MainActivity mainActivity;    @Override    public View onCreateView(LayoutInflater inflater, ViewGroup container,                             Bundle savedInstanceState) {        // Inflate the layout for this fragment        view =  inflater.inflate(R.layout.fragment_choose, container, false);        return  view;    }    @Override    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {        super.onViewCreated(view, savedInstanceState);        init();        initsetup();    }    private void initsetup() {        new LoadInstallPacket().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR,getActivity());        gridView.setOnItemClickListener(this);    }    private void init() {        gridView  = view.findViewById(R.id.gridAppView);        mainActivity = (MainActivity) getActivity();    }    private  void fillGridView(List<PackageInfo> packageInfos){        this.packageInfos = packageInfos;        GridViewAdapter gridViewAdapter  = new GridViewAdapter(getActivity(),packageInfos);        gridView.setAdapter(gridViewAdapter);    }    ////////////////////////////////////////////////////////////////////Listener/////////////////////////////////////////////////    @Override    public void onItemClick(AdapterView<?> adapterView, View view, int i, long l) {        Intent launchIntent = getActivity().getPackageManager().getLaunchIntentForPackage(                packageInfos.get(i).packageName        );        startActivity(launchIntent);        //gửi thông tin này lên server        Talkcontent talkcontent = new Talkcontent();        talkcontent.TalkCode = TalkCode.STARTEDGAME;        mainActivity.socketworker.GiveDatatoPc(talkcontent);        //khởi đông service        Intent Gamesv = new Intent(getActivity(), GameService.class);        mainActivity.startService(Gamesv);    }    //TODO : custom class    private class   LoadInstallPacket extends AsyncTask<Context,Void,List<PackageInfo>> {        @Override        protected List<PackageInfo> doInBackground(Context... contexts) {            List<PackageInfo>  packageInfoList = LoadGappsCurrent.installedApps(contexts[0]);            return  packageInfoList;        }        @Override        protected void onPostExecute(List<PackageInfo> packageInfos) {            fillGridView(packageInfos);        }    }}